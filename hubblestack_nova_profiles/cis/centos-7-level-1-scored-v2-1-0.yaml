grep:
  whitelist:
    rsyslog_remote_logging:
      data:
        CentOS Linux-7:
        - /etc/rsyslog.conf:
            pattern: ^*.*[^I][^I]*@
            tag: CIS-4.2.1.4
      description: Ensure rsyslog is configured to send logs to a remote log host
    sshd_limit_access:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            pattern: '^AllowUsers|^AllowGroups|^DenyUsers|^DenyGroups'
            grep_args:
              - '-E'
            tag: CIS-5.2.15
      description: Ensure SSH access is limited
    default_umask:
      data:
        CentOS Linux-7:
        - /etc/bashrc:
            pattern: umask
            match_pattern: '027'
            tag: CIS-5.4.4
        - /etc/profile.d:
            pattern: umask
            match_pattern: '027'
            grep_args:
              - '-r'
            tag: CIS-5.4.4
      description: Ensure default user umask is 027 or more restrictive
    limit_su_command_access:
      data:
        CentOS Linux-7:
        - /etc/pam.d/su:
            match_output: use_uid
            pattern: '^[[:blank:]]*[^[:blank:]#;].*pam_wheel.so'
            tag: CIS-5.6
        - /etc/group:
            pattern: '^[[:blank:]]*[^[:blank:]#;].*wheel'
            tag: CIS-5.6
      description: Ensure access to the su command is restricted
    sshd_protocol_2:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: Protocol\s+2
            match_output_regex: True
            pattern: ^Protocol
            tag: CIS-5.2.2
      description: Ensure SSH Protocol is set to 2
    sshd_loglevel_info:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: LogLevel\s+INFO
            match_output_regex: True
            pattern: ^LogLevel
            tag: CIS-5.2.3
      description: Ensure SSH LogLevel is set to INFO
    sshd_x11_forwarding:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: X11Forwarding\s+no
            pattern: ^X11Forwarding
            match_output_regex: True
            tag: CIS-5.2.4
      description: Ensure SSH X11 forwarding is disabled
    sshd_max_auth_retries:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: ^MaxAuthTries\s+[1-4]$
            pattern: ^MaxAuthTries
            match_output_regex: True
            tag: CIS-5.2.5
      description: Ensure SSH MaxAuthTries is set to 4 or less
    sshd_ignore_rhosts:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: IgnoreRhosts\s+yes
            match_output_regex: True
            pattern: ^IgnoreRhosts
            tag: CIS-5.2.6
      description: Ensure SSH IgnoreRhosts is enabled
    sshd_hostbased_auth:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: HostbasedAuthentication\s+no
            match_output_regex: True
            pattern: ^HostbasedAuthentication
            tag: CIS-5.2.7
      description: Ensure SSH HostbasedAuthentication is disabled
    sshd_disable_root_login:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: PermitRootLogin\s+no
            match_output_regex: True
            pattern: ^PermitRootLogin
            tag: CIS-5.2.8
      description: Ensure SSH root login is disabled
    sshd_permit_empty_passwords:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: PermitEmptyPasswords\s+no
            match_output_regex: True
            pattern: ^PermitEmptyPasswords
            tag: CIS-5.2.9
      description: Ensure SSH PermitEmptyPasswords is disabled
    sshd_permit_user_environment:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: PermitUserEnvironment\s+no
            match_output_regex: True
            pattern: ^PermitUserEnvironment
            tag: CIS-5.2.10
      description: Ensure SSH PermitUserEnvironment is disabled
    sshd_idle_timeout:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            match_output: ClientAliveInterval 300
            pattern: ^ClientAliveInterval
            tag: CIS-5.2.13
        - /etc/ssh/sshd_config:
            match_output: ClientAliveCountMax 0
            pattern: ^ClientAliveCountMax
            tag: CIS-5.2.13
      description: Ensure SSH Idle Timeout Interval is configured
    sshd_gracetime:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            pattern: ^LoginGraceTime
            match_output: '60'
            tag: CIS-5.2.14
      description: Ensure SSH LoginGraceTime is set to one minute or less
    sshd_banner:
      data:
        CentOS Linux-7:
        - /etc/ssh/sshd_config:
            pattern: ^Banner
            tag: CIS-5.2.16
      description: Ensure SSH warning banner is configured
    pam_pwquality_try_first_pass:
      data:
        CentOS Linux-7:
        - /etc/pam.d/system-auth:
            match_output: try_first_pass
            pattern: pam_pwquality.so
            tag: CIS-5.3.1
        - /etc/pam.d/system-auth:
            match_output: retry=3
            pattern: pam_pwquality.so
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: minlen
            match_output: '14'
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: dcredit
            match_output: '-1'
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: ucredit
            match_output: '-1'
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: ocredit
            match_output: '-1'
            tag: CIS-5.3.1
        - /etc/security/pwquality.conf:
            pattern: lcredit
            match_output: '-1'
            tag: CIS-5.3.1
      description: Ensure password creation requirements are configured
    lockout_account:
      data:
        CentOS Linux-7:
        - /etc/pam.d/system-auth:
            pattern: '"^auth\s+required\s+pam_faillock\.so.*"'
            match_output: deny=5
            grep_args:
              - '-E'
            tag: CIS-5.3.2
        - /etc/pam.d/password-auth:
            pattern: '"^auth\s+required\s+pam_faillock\.so.*"'
            match_output: deny=5
            grep_args:
              - '-E'
            tag: CIS-5.3.2
      description: Ensure lockout for failed password attempts is configured
    limit_password_reuse:
      data:
        CentOS Linux-7:
        - /etc/pam.d/system-auth:
            pattern: '"^password\s+sufficient\s+pam_unix\.so.*"'
            match_output: remember=5
            grep_args:
              - '-E'
            tag: CIS-5.3.3
        - /etc/pam.d/password-auth:
            pattern: '"^password\s+sufficient\s+pam_unix\.so.*"'
            match_output: remember=5
            grep_args:
              - '-E'
            tag: CIS-5.3.3
      description: Ensure password reuse is limited
    password_hash:
      data:
        CentOS Linux-7:
        - /etc/pam.d/password-auth:
            pattern: '"^password\s+\w+\s+pam_unix\.so"'
            match_output: sha512
            grep_args:
              - '-E'
            tag: CIS-5.3.4
        - /etc/pam.d/system-auth:
            pattern: '"^password\s+\w+\s+pam_unix\.so"'
            match_output: sha512
            grep_args:
              - '-E'
            tag: CIS-5.3.4
      description: Ensure password hashing algorithm is SHA-512
    disable_mount_cramfs:
      data:
        CentOS Linux-7:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: '^[[:blank:]]*[^[:blank:]#;].*cramfs'
            grep_args:
              - '-r'
            tag: CIS-1.1.1.1
      description: Ensure mounting of cramfs filesystems is disabled
    disable_mount_freevxfs:
      data:
        CentOS Linux-7:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: '^[[:blank:]]*[^[:blank:]#;].*freevxfs'
            grep_args:
              - '-r'
            tag: CIS-1.1.1.2
      description: Ensure mounting of freevxfs filesystems is disabled
    disable_mount_jffs2:
      data:
        CentOS Linux-7:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: '^[[:blank:]]*[^[:blank:]#;].*jffs2'
            grep_args:
              - '-r'
            tag: CIS-1.1.1.3
      description: Ensure mounting of jffs2 filesystems is disabled
    disable_mount_hfs:
      data:
        CentOS Linux-7:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: '^[[:blank:]]*[^[:blank:]#;].*hfs'
            grep_args:
              - '-r'
            tag: CIS-1.1.1.4
      description: Ensure mounting of hfs filesystems is disabled
    disable_mount_hfsplus:
      data:
        CentOS Linux-7:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: '^[[:blank:]]*[^[:blank:]#;].*hfsplus'
            grep_args:
              - '-r'
            tag: CIS-1.1.1.5
      description: Ensure mounting of hfsplus filesystems is disabled
    disable_mount_squashfs:
      data:
        CentOS Linux-7:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: '^[[:blank:]]*[^[:blank:]#;].*squashfs'
            grep_args:
              - '-r'
            tag: CIS-1.1.1.6
      description: Ensure mounting of squashfs filesystems is disabled
    disable_mount_udf:
      data:
        CentOS Linux-7:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: '^[[:blank:]]*[^[:blank:]#;].*udf'
            grep_args:
              - '-r'
            tag: CIS-1.1.1.7
      description: Ensure mounting of udf filesystems is disabled
    disable_mount_fat:
      data:
        CentOS Linux-7:
        - /etc/modprobe.d:
            match_output: /bin/true
            pattern: '^[[:blank:]]*[^[:blank:]#;].*vfat'
            grep_args:
              - '-r'
            tag: CIS-1.1.1.8
      description: Ensure mounting of FAT filesystems is disabled
    chargen_disabled:
      data:
        CentOS Linux-7:
        - /etc/xinetd.d/chargen-dgram:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.1
            match_on_file_missing: True
        - /etc/xinetd.d/chargen-stream:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.1
            match_on_file_missing: True
      description: Ensure chargen services are not enabled
    daytime_disabled:
      data:
        CentOS Linux-7:
        - /etc/xinetd.d/daytime-dgram:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.2
            match_on_file_missing: True
        - /etc/xinetd.d/daytime-stream:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.2
            match_on_file_missing: True
      description: Ensure daytime services are not enabled
    discard_disabled:
      data:
        CentOS Linux-7:
        - /etc/xinetd.d/discard-dgram:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.3
            match_on_file_missing: True
        - /etc/xinetd.d/discard-stream:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.3
            match_on_file_missing: True
      description: Ensure discard services are not enabled
    echo_disabled:
      data:
        CentOS Linux-7:
        - /etc/xinetd.d/echo-dgram:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.4
            match_on_file_missing: True
        - /etc/xinetd.d/echo-stream:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.4
            match_on_file_missing: True
      description: Ensure echo services are not enabled
    time_disabled:
      data:
        CentOS Linux-7:
        - /etc/xinetd.d/time-dgram:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.5
            match_on_file_missing: True
        - /etc/xinetd.d/time-stream:
            pattern: disable
            match_output: 'yes'
            tag: CIS-2.1.5
            match_on_file_missing: True
      description: Ensure time services are not enabled
  blacklist:
    banner_os_info_motd:
      data:
        CentOS Linux-7:
        - /etc/motd:
            pattern: '\\\\v'
            tag: CIS-1.7.1.1
        - /etc/motd:
            pattern: '\\\\r'
            tag: CIS-1.7.1.1
        - /etc/motd:
            pattern: '\\\\m'
            tag: CIS-1.7.1.1
        - /etc/motd:
            pattern: '\\\\s'
            tag: CIS-1.7.1.1
      description: Ensure message of the day is configured properly

misc:
  sticky_bit_on_writable_directories:
    data:
      CentOS Linux-7:
       tag: CIS-1.1.21
       function: sticky_bit_on_world_writable_dirs
       description: Ensure sticky bit is set on all world-writable directories
  restrict_core_dumps:
    data:
      CentOS Linux-7:
       tag: CIS-1.5.1
       function: check_core_dumps
       description: Ensure core dumps are restricted
  mail_configured_for_local_only_mode:
    data:
      CentOS Linux-7:
       tag: CIS-2.2.15
       function: mail_conf_check
       description: Ensure mail transfer agent is configured for local-only mode
  no_world_writable_file:
    data:
      CentOS Linux-7:
       tag: CIS-6.1.10
       function: world_writable_file
       description: Ensure no world writable files exist
  no_unowned_file_or_directories:
    data:
      CentOS Linux-7:
       tag: CIS-6.1.11
       function: unowned_files_or_dir
       description: Ensure no unowned files or directories exist
  no_ungrouped_file_or_directories:
    data:
      CentOS Linux-7:
       tag: CIS-6.1.12
       function: ungrouped_files_or_dir
       description: Ensure no ungrouped files or directories exist
  root_is_only_uid_0_account:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.5
       function: root_is_only_uid_0_account
       description: Ensure root is the only UID 0 account
  ensure_path_integrity:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.6
       function: check_path_integrity
       description: Ensure root PATH Integrity
  all_users_home_directory:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.7
       function: check_all_users_home_directory
       args:
         - 1000
       description: Ensure all users' home directories exist
  all_users_home_directory_permission:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.8
       function: check_users_home_directory_permissions
       description: Ensure users' home directories permissions are 750 or more restrictive
  all_users_own_their_home:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.9
       function: check_users_own_their_home
       args:
         - 1000
       description: Ensure users own their home directories
  users_dot_file_check:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.10
       function: check_users_dot_files
       description: Ensure users' dot files are not group or world writable
  users_forward_files_check:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.11
       function: check_users_forward_files
       description: Ensure no users have .forward files
  users_netrc_files_check:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.12
       function: check_users_netrc_files
       description: Ensure no users have .netrc files
  check_groups_validity:
    data:
      CentOS Linux-7:
       tag: CIS-6.2.15
       function: check_groups_validity
       description: Ensure all groups in /etc/passwd exist in /etc/group
  ensure_ntp_configured:
    data:
      CentOS Linux-7:
       tag: CIS-2.2.1.2
       function: check_list_values
       args:
         - /etc/ntp.conf
         - '^restrict.*default'
         - '^restrict.*default(.*)$'
         - null
         - nomodify,notrap,kod,nopeer,noquery
         - null
         - ' '
       description: Ensure ntp is configured
  ensure_rsyslog_configured:
    data:
      CentOS Linux-7:
       tag: CIS-5.2.12
       function: check_list_values
       args:
         - /etc/ssh/sshd_config
         - '^MACs'
         - '^MACs(.*)$'
         - null
         - hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com,curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256
         - null
         - ','
       description: Ensure only approved MAC algorithms are used
  ensure_rsyslog_configured:
    data:
      CentOS Linux-7:
       tag: CIS-5.2.11
       function: check_list_values
       args:
         - /etc/ssh/sshd_config
         - '^Ciphers'
         - '^Ciphers(.*)$'
         - null
         - 'aes256-ctr,aes192-ctr,aes128-ctr,aes256-gcm@openssh.com,aes128-gcm@openssh.com,chacha20-poly1305@openssh.com'
         - null
         - ','
       description: Ensure only approved ciphers are used

sysctl:
  restrict_suid_core_dumps:
    data:
      CentOS Linux-7:
      - fs.suid_dumpable:
          match_output: '0'
          tag: CIS-1.5.1
    description: Ensure core dumps are restricted
  randomize_va_space:
    data:
      CentOS Linux-7:
      - kernel.randomize_va_space:
          match_output: '2'
          tag: CIS-1.5.3
    description: Ensure address space layout randomization (ASLR) is enabled
  ip_forwarding:
    data:
      CentOS Linux-7:
      - net.ipv4.ip_forward:
          match_output: '0'
          tag: CIS-3.1.1
    description: Ensure IP forwarding is disabled
  send_packet_redirect:
    data:
      CentOS Linux-7:
      - net.ipv4.conf.all.send_redirects:
          match_output: '0'
          tag: CIS-3.1.2
      - net.ipv4.conf.default.send_redirects:
          match_output: '0'
          tag: CIS-3.1.2
    description: Ensure packet redirect sending is disabled
  source_routed_packet_acceptance:
    data:
      CentOS Linux-7:
      - net.ipv4.conf.all.accept_source_route:
          match_output: '0'
          tag: CIS-3.2.1
      - net.ipv4.conf.default.accept_source_route:
          match_output: '0'
          tag: CIS-3.2.1
    description: Ensure source routed packets are not accepted
  icmp_redirect_acceptance:
    data:
      CentOS Linux-7:
      - net.ipv4.conf.all.accept_redirects:
          match_output: '0'
          tag: CIS-3.2.2
      - net.ipv4.conf.default.accept_redirects:
          match_output: '0'
          tag: CIS-3.2.2
    description: Ensure ICMP redirects are not accepted
  secure_icmp_redirect_acceptance:
    data:
      CentOS Linux-7:
      - net.ipv4.conf.all.secure_redirects:
          match_output: '0'
          tag: CIS-3.2.3
      - net.ipv4.conf.default.secure_redirects:
          match_output: '0'
          tag: CIS-3.2.3
    description: Ensure secure ICMP redirects are not accepted
  log_suspicious_packets:
    data:
      CentOS Linux-7:
      - net.ipv4.conf.all.log_martians:
          match_output: '1'
          tag: CIS-3.2.4
      - net.ipv4.conf.default.log_martians:
          match_output: '1'
          tag: CIS-3.2.4
    description: Ensure suspicious packets are logged
  ignore_broadcast_requests:
    data:
      CentOS Linux-7:
      - net.ipv4.icmp_echo_ignore_broadcasts:
          match_output: '1'
          tag: CIS-3.2.5
    description: Ensure broadcast ICMP requests are ignored
  bad_error_message_protection:
    data:
      CentOS Linux-7:
      - net.ipv4.icmp_ignore_bogus_error_responses:
          match_output: '1'
          tag: CIS-3.2.6
    description: Ensure bogus ICMP responses are ignored
  reverse_path_filtering:
    data:
      CentOS Linux-7:
      - net.ipv4.conf.all.rp_filter:
          match_output: '1'
          tag: CIS-3.2.7
      - net.ipv4.conf.default.rp_filter:
          match_output: '1'
          tag: CIS-3.2.7
    description: Ensure Reverse Path Filtering is enabled
  tcp_syn_cookies:
    data:
      CentOS Linux-7:
      - net.ipv4.tcp_syncookies:
          match_output: '1'
          tag: CIS-3.2.8
    description: Ensure TCP SYN Cookies is enabled
pkg:
  whitelist:
    tcp_wrappers:
      data:
        CentOS Linux-7:
        - tcp_wrappers: CIS-3.4.1
        - tcp_wrappers-libs: CIS-3.4.1
      description: Ensure TCP Wrappers is installed
  blacklist:
    prelink:
      data:
        CentOS Linux-7:
        - prelink: CIS-1.5.4
      description: Ensure prelink is disabled
    tftp-server2:
      data:
        CentOS Linux-7:
        - tftp-server: CIS-2.1.6
      description: Ensure tftp server is not enabled
    xinetd:
      data:
        CentOS Linux-7:
        - xinetd: CIS-2.1.7
      description: Ensure xinetd is not enabled
    xorg-x11-server-common:
      data:
        CentOS Linux-7:
        - xorg-x11-server-common: CIS-2.1.7
      description: Ensure xinetd is not enabled
    nis-client:
      data:
        CentOS Linux-7:
        - ypbind: CIS-2.3.1
      description: Ensure NIS Client is not installed
    rsh:
      data:
        CentOS Linux-7:
        - rsh: CIS-2.3.2
      description: Ensure rsh client is not installed
    talk-client:
      data:
        CentOS Linux-7:
        - talk: CIS-2.3.3
      description: Ensure talk client is not installed
    telnet-client:
      data:
        CentOS Linux-7:
        - telnet: CIS-2.3.4
      description: Ensure telnet client is not installed
    ldap_clients:
      data:
        CentOS Linux-7:
        - openldap-clients: CIS-2.3.5
      description: Ensure LDAP client is not installed


stat:
  warning_banner_issue:
    data:
      CentOS Linux-7:
      - /etc/issue:
          gid: 0
          group: root
          mode: 644
          tag: CIS-1.7.1.5
          uid: 0
          user: root
    description: Ensure permissions on /etc/issue are configured
  crontab:
    data:
      CentOS Linux-7:
      - /etc/crontab:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.2
          uid: 0
          user: root
    description: Ensure permissions on /etc/crontab are configured
  cron_hourly:
    data:
      CentOS Linux-7:
      - /etc/cron.hourly:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.3
          uid: 0
          user: root
    description: Ensure permissions on /etc/cron.hourly are configured
  cron_daily:
    data:
      CentOS Linux-7:
      - /etc/cron.daily:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.4
          uid: 0
          user: root
    description: Ensure permissions on /etc/cron.daily are configured
  cron_weekly:
    data:
      CentOS Linux-7:
      - /etc/cron.weekly:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.5
          uid: 0
          user: root
    description: Ensure permissions on /etc/cron.weekly are configured
  cron_monthly:
    data:
      CentOS Linux-7:
      - /etc/cron.monthly:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.6
          uid: 0
          user: root
    description: Ensure permissions on /etc/cron.monthly are configured
  cron_d:
    data:
      CentOS Linux-7:
      - /etc/cron.d:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.7
          uid: 0
          user: root
    description: Ensure permissions on /etc/cron.d are configured
  at_cron_allow:
    data:
      CentOS Linux-7:
      - /etc/cron.deny:
          gid: null
          group: null
          mode: null
          tag: CIS-5.1.8
          uid: null
          user: null
      - /etc/at.deny:
          gid: null
          group: null
          mode: null
          tag: CIS-5.1.8
          uid: null
          user: null
      - /etc/cron.allow:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.8
          uid: 0
          user: root
      - /etc/at.allow:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.1.8
          uid: 0
          user: root
    description: Ensure at/cron is restricted to authorized users
  sshd_config:
    data:
      CentOS Linux-7:
      - /etc/ssh/sshd_config:
          gid: 0
          group: root
          mode: 600
          tag: CIS-5.2.1
          uid: 0
          user: root
    description: Ensure permissions on /etc/ssh/sshd_config are configured
  passwd_own_perm:
    data:
      CentOS Linux-7:
      - /etc/passwd:
          group: root
          tag: CIS-6.1.2
          mode: 644
          uid: 0
          user: root
    description: Ensure permissions on /etc/passwd are configured
  shadow_own_perm:
    data:
      CentOS Linux-7:
      - /etc/shadow:
          gid: 0
          group: root
          mode: 000
          tag: CIS-6.1.3
          uid: 0
          user: root
    description: Ensure permissions on /etc/shadow are configured
  group_own_perm:
    data:
      CentOS Linux-7:
      - /etc/group:
          gid: 0
          group: root
          mode: 644
          tag: CIS-6.1.4
          uid: 0
          user: root
    description: Ensure permissions on /etc/group are configured
  gshadow_own_perm:
    data:
      CentOS Linux-7:
      - /etc/gshadow:
          gid: 0
          group: root
          mode: 600
          tag: CIS-6.1.5
          uid: 0
          user: root
    description: Ensure permissions on /etc/gshadow are configured
  passwd-_own_perm:
    data:
      CentOS Linux-7:
      - /etc/passwd-:
          group: root
          tag: CIS-6.1.6
          mode: 600
          allow_more_strict: True
          uid: 0
          user: root
    description: Ensure permissions on /etc/passwd- are configured
  shadow-_own_perm:
    data:
      CentOS Linux-7:
      - /etc/shadow-:
          gid: 0
          group: root
          mode: 600
          allow_more_strict: True
          tag: CIS-6.1.7
          uid: 0
          user: root
    description: Ensure permissions on /etc/shadow- are configured
  group-_own_perm:
    data:
      CentOS Linux-7:
      - /etc/group-:
          gid: 0
          group: root
          mode: 600
          allow_more_strict: True
          tag: CIS-6.1.8
          uid: 0
          user: root
    description: Ensure permissions on /etc/group- are configured
  gshadow-_own_perm:
    data:
      CentOS Linux-7:
      - /etc/gshadow-:
          gid: 0
          group: root
          mode: 600
          allow_more_strict: True
          tag: CIS-6.1.9
          uid: 0
          user: root
    description: Ensure permissions on /etc/gshadow- are configured

systemctl:
  whitelist:
    rsyslog_enabled:
      data:
        CentOS Linux-7:
        - rsyslog:
           tag: CIS-4.2.1.1
      description: Ensure rsyslog Service is enabled
    cron_deamon_enabled:
      data:
        CentOS Linux-7:
        - crond:
           tag: CIS-5.1.1
      description: Ensure cron daemon is enabled
  blacklist:
    avahi-daemon-disabled:
      data:
        CentOS Linux-7:
        - avahi-daemon:
            tag: CIS-2.2.3
      description: Ensure Avahi Server is not enabled
    cups-disabled:
      data:
        CentOS Linux-7:
        - cups:
            tag: CIS-2.2.4
      description: Ensure CUPS is not enabled
    dhcpd-disabled:
      data:
        CentOS Linux-7:
        - dhcpd:
            tag: CIS-2.2.5
      description: Ensure DHCP Server is not enabled
    ldap-server-disabled:
      data:
        CentOS Linux-7:
        - slapd:
            tag: CIS-2.2.6
      description: Ensure LDAP server is not enabled
    nfs-disabled:
      data:
        CentOS Linux-7:
        - nfs:
            tag: CIS-2.2.7
      description: Ensure NFS and RPC are not enabled
    rpc-disabled:
      data:
        CentOS Linux-7:
        - rpcbind:
            tag: CIS-2.2.7
      description: Ensure NFS and RPC are not enabled
    dns-server-disabled:
      data:
        CentOS Linux-7:
        - named:
            tag: CIS-2.2.8
      description: Ensure DNS Server is not enabled
    ftp-server-disabled:
      data:
        CentOS Linux-7:
        - vsftpd:
            tag: CIS-2.2.9
      description: Ensure FTP Server is not enabled
    http-server-disabled:
      data:
        CentOS Linux-7:
        - httpd:
            tag: CIS-2.2.10
      description: Ensure HTTP server is not enabled
    imap-pop3-server-disabled:
      data:
        CentOS Linux-7:
        - dovecot:
            tag: CIS-2.2.11
      description: Ensure IMAP and POP3 server is not enabled
    samba-server-disabled:
      data:
        CentOS Linux-7:
        - smb:
            tag: CIS-2.2.12
      description: Ensure Samba is not enabled
    http-proxy-server-disabled:
      data:
        CentOS Linux-7:
        - squid:
            tag: CIS-2.2.13
      description: Ensure HTTP Proxy Server is not enabled
    snmp-server-disabled:
      data:
        CentOS Linux-7:
        - snmpd:
            tag: CIS-2.2.14
      description: Ensure SNMP Server is not enabled
    nis-server-disabled:
      data:
        CentOS Linux-7:
        - ypserv:
            tag: CIS-2.2.16
      description: Ensure NIS Server is not enabled
    rsh-socket-disabled:
      data:
        CentOS Linux-7:
        - rsh.socket:
            tag: CIS-2.2.17
      description: Ensure rsh Server is not enabled
    rlogin-socket-disabled:
      data:
        CentOS Linux-7:
        - rlogin.socket:
            tag: CIS-2.2.17
      description: Ensure rsh Server is not enabled
    rexec-socket-disabled:
      data:
        CentOS Linux-7:
        - rexec.socket:
            tag: CIS-2.2.17
      description: Ensure rsh Server is not enabled
    telnet-server-disabled:
      data:
        CentOS Linux-7:
        - telnet.socket:
            tag: CIS-2.2.18
      description: Ensure telnet server is not enabled
    tftp-server-disabled:
      data:
        CentOS Linux-7:
        - tftp.socket:
            tag: CIS-2.2.19
      description: Ensure tftp server is not enabled
    rsync-service-disabled:
      data:
        CentOS Linux-7:
        - rsyncd:
            tag: CIS-2.2.20
      description: Ensure rsync service is not enabled
    talk-server-disabled:
      data:
        CentOS Linux-7:
        - ntalk:
            tag: CIS-2.2.21
      description: Ensure talk server is not enabled
mount:
  whitelist:
    ensure_nodev_option_on_/tmp:
      data:
        CentOS Linux-7:
        - /tmp:
            attribute: nodev
            check_type: soft
            tag: CIS-1.1.3
      description: Ensure nodev option set on /tmp partition
    ensure_nosuid_option_on_/tmp:
      data:
        CentOS Linux-7:
        - /tmp:
            attribute: nosuid
            check_type: soft
            tag: CIS-1.1.4
      description: Ensure nosuid option set on /tmp partition
    ensure_noexec_option_on_/tmp:
      data:
        CentOS Linux-7:
        - /tmp:
            attribute: noexec
            check_type: soft
            tag: CIS-1.1.5
      description: Ensure noexec option set on /tmp partition
    ensure_nodev_option_on_/var/tmp:
      data:
        CentOS Linux-7:
        - /var/tmp:
            attribute: nodev
            check_type: soft
            tag: CIS-1.1.8
      description: Ensure nodev option set on /var/tmp partition
    ensure_nosuid_option_on_/var/tmp:
      data:
        CentOS Linux-7:
        - /var/tmp:
            attribute: nosuid
            check_type: soft
            tag: CIS-1.1.9
      description: Ensure nosuid option set on /var/tmp partition
    ensure_noexec_option_on_/var/tmp:
      data:
        CentOS Linux-7:
        - /var/tmp:
            attribute: noexec
            check_type: soft
            tag: CIS-1.1.10
      description: Ensure noexec option set on /var/tmp partition
    ensure_nodev_option_on_/home:
      data:
        CentOS Linux-7:
        - /home:
            attribute: nodev
            check_type: soft
            tag: CIS-1.1.14
      description: Ensure nodev option set on /home partition
    ensure_nodev_option_on_/dev/shm:
      data:
        CentOS Linux-7:
        - /dev/shm:
            attribute: nodev
            check_type: soft
            tag: CIS-1.1.15
      description: Ensure nodev option set on /dev/shm partition
    ensure_nosuid_option_on_/dev/shm:
      data:
        CentOS Linux-7:
        - /dev/shm:
            attribute: nosuid
            check_type: soft
            tag: CIS-1.1.16
      description: Ensure nosuid option set on /dev/shm partition
    ensure_noexec_option_on_/dev/shm:
      data:
        CentOS Linux-7:
        - /dev/shm:
            attribute: noexec
            check_type: soft
            tag: CIS-1.1.17
      description: Ensure noexec option set on /dev/shm partition
